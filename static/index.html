<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Comparador de Precios</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- SheetJS opcional para XLSX -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <header>
    <h1>Comparador de Precios</h1>
    <!-- Subtítulo oculto para UI pública -->
  </header>

  <nav class="tabs">
    <button data-tab="input" class="active">Input</button>
    <button data-tab="config">Configuración</button>
    <button data-tab="results">Resultados</button>
    <button data-tab="export">Exportar</button>
  </nav>

  <main>
    <section id="input" class="tab active">
      <h3>Importar productos</h3>
      <div class="import-wrap">
        <input id="fileInput" type="file" accept=".csv,.xlsx" />
        <button id="parseFile">Subir CSV/XLSX</button>
        <span class="hint">Máx: 5 ítems por lote</span>
        <button id="openPaste">Pegar desde tabla</button>
        <span class="hint">Máx: 5 ítems por lote</span>
      </div>
      <div id="pasteBox" class="paste-box" style="display:none;">
        <p>Pega desde Excel/Sheets con columnas: Producto | Marca | Modelo | Capacidad | EAN</p>
        <textarea id="pasteArea" rows="8" style="width:100%;"></textarea>
        <div style="margin-top:8px;">
          <button id="importPaste">Importar</button>
          <button id="closePaste" class="secondary">Cerrar</button>
        </div>
      </div>

      <h3>Productos</h3>
      <div>
        <button id="addProduct">Agregar producto</button>
        <button id="loadSamples" class="secondary">Cargar ejemplo</button>
      </div>
      <table id="productsTable">
        <thead>
          <tr>
            <th>Producto</th>
            <th>Marca</th>
            <th>Modelo</th>
            <th>Capacidad</th>
            <th>EAN/Código</th>
            <th></th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <h3>Vendedores</h3>
      <div class="btn-row">
        <button id="addVendor">Agregar vendedor</button>
      </div>
      <table id="vendorsTable">
        <thead>
          <tr><th>Nombre</th><th>URL</th><th></th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <section id="config" class="tab">
      <h3>Parámetros</h3>
      <div class="grid">
        <label>Headless:
          <select id="headless">
            <option value="true" selected>Sí</option>
            <option value="false">No</option>
          </select>
        </label>
        <label>Delay mínimo (s): <input id="minDelay" type="number" value="2" min="1" max="10" /></label>
        <label>Delay máximo (s): <input id="maxDelay" type="number" value="5" min="1" max="10" /></label>
        <label>Incluir sitio oficial de marca (marcar ND por ahora):
          <select id="official">
            <option value="false" selected>No</option>
            <option value="true">Sí</option>
          </select>
        </label>
      </div>
      <button id="start" class="btn-cta">INICIAR BÚSQUEDA</button>
      <button id="clearResults">Limpiar resultados</button>
      <div id="status"></div>
    </section>

    <section id="results" class="tab">
      <h3>Tabla de comparación</h3>
      <div class="table-wrap">
        <table id="resultsTable">
          <thead>
            <tr>
              <th>Producto</th>
              <th>Marca</th>
              <th>Carrefour</th>
              <th>Cetrogar</th>
              <th>CheekSA</th>
              <th>Frávega</th>
              <th>Libertad</th>
              <th>Masonline</th>
              <th>Megatone</th>
              <th>Musimundo</th>
              <th>Naldo</th>
              <th>Vital</th>
              <th>Marca (Sitio oficial)</th>
              <th>Fecha de Consulta</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <section id="export" class="tab">
      <h3>Exportar resultados</h3>
      <button id="toCSV">Exportar CSV</button>
      <button id="copyTable">Copiar tabla</button>
      <div class="sheets">
        <label>Nombre de Google Sheet:
          <input id="sheetName" type="text" value="Comparación Precios Electrodomésticos" />
        </label>
        <button id="toSheets">Exportar a Google Sheets</button>
      </div>
      <p>Para habilitar Google Sheets, sube un credentials.json o configura GOOGLE_CREDENTIALS_BASE64 en el servidor.</p>
    </section>
  </main>

  <script src="./script.js"></script>
</body>
</html>
